<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Multiplayer Quiz ‚Äì Game (Offline Test)</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <h1>Multiplayer Quiz</h1>
  <div id="question-container">
    <h2 id="question-text">Loading...</h2>
    <div id="answers"></div>
    <p>‚è≥ Time left: <span id="time-left">-</span></p>
    <p class="score">Your Score: <span id="score">0</span></p>
  </div>

  <script>
    // Sample questions
    const pathology = [
      { question: "What cell type proliferates in acute inflammation?", options: ["Neutrophil", "Lymphocyte", "Macrophage", "Basophil"], correct: 0 },
      { question: "Which organ is most affected by amyloidosis?", options: ["Liver", "Heart", "Brain", "Lung"], correct: 1 },
      { question: "Which type of necrosis is typical in myocardial infarction?", options: ["Coagulative", "Liquefactive", "Caseous", "Fat"], correct: 0 },
    ];

    const pharmacology = [
      { question: "Which drug is a Œ≤‚Äëblocker?", options: ["Propranolol", "Lisinopril", "Losartan", "Verapamil"], correct: 0 },
      { question: "Which drug inhibits ACE?", options: ["Lisinopril", "Losartan", "Hydralazine", "Propranolol"], correct: 0 },
      { question: "Which is a loop diuretic?", options: ["Furosemide", "HCTZ", "Spironolactone", "Acetazolamide"], correct: 0 },
    ];

    // Choose one category manually here for testing
    const category = 'pathology'; // or 'pharmacology'
    const questions = shuffle(category === 'pathology' ? pathology : pharmacology);

    // Quiz variables
    let score = 0;
    let currentIndex = 0;
    let timerInterval = null;

    // DOM elements
    const questionText = document.getElementById('question-text');
    const answersDiv = document.getElementById('answers');
    const timeLeft = document.getElementById('time-left');
    const scoreEl = document.getElementById('score');

    function shuffle(arr) {
      return [...arr].sort(() => Math.random() - 0.5);
    }

    function startGame() {
      setTimeout(() => startQuestionLoop(), 500);
    }

    function startQuestionLoop() {
      clearInterval(timerInterval);
      displayQuestion();
      let startTime = Date.now();

      timerInterval = setInterval(() => {
        const elapsed = Math.floor((Date.now() - startTime) / 1000);
        const rem = 10 - elapsed;
        timeLeft.textContent = rem > 0 ? rem : 0;
        if (rem <= 0) {
          clearInterval(timerInterval);
          lockButtons();
          goNextQuestion();
        }
      }, 200);
    }

    function displayQuestion() {
      const q = questions[currentIndex];
      if (!q) {
        showEndScreen();
        return;
      }
      questionText.textContent = q.question;
      answersDiv.innerHTML = '';
      scoreEl.textContent = score;

      q.options.forEach((opt, i) => {
        const btn = document.createElement('button');
        btn.textContent = opt;
        btn.onclick = () => answerQuestion(i);
        answersDiv.appendChild(btn);
      });
    }

    function lockButtons() {
      document.querySelectorAll('#answers button').forEach(btn => btn.disabled = true);
    }

    function answerQuestion(index) {
      const q = questions[currentIndex];
      const btns = answersDiv.querySelectorAll('button');
      lockButtons();

      if (index === q.correct) {
        btns[index].classList.add('correct');
        score += 10;
      } else {
        btns[index].classList.add('incorrect');
        btns[q.correct].classList.add('correct');
      }

      scoreEl.textContent = score;
    }

    function goNextQuestion() {
      currentIndex++;
      if (currentIndex < questions.length) {
        startQuestionLoop();
      } else {
        showEndScreen();
      }
    }

    function showEndScreen() {
      clearInterval(timerInterval);
      questionText.textContent = "üéâ Quiz Complete!";
      answersDiv.innerHTML = '';
      timeLeft.textContent = '-';
    }

    startGame();
  </script>
</body>
</html>